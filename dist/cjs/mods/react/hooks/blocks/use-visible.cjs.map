{"version":3,"file":"use-visible.cjs","sources":["../../../../../../src/mods/react/hooks/blocks/use-visible.ts"],"sourcesContent":["import { useAutoRef } from \"libs/react.js\"\nimport { Query } from \"mods/react/types/query.js\"\nimport { useEffect } from \"react\"\n\n/**\n * Do a request when the tab is visible\n * @param query \n */\nexport function useVisible(query: Query) {\n  const { ready, fetch } = query\n\n  const fetchRef = useAutoRef(fetch)\n\n  useEffect(() => {\n    if (!ready) return\n\n    const f = () => !document.hidden && fetchRef.current()\n\n    document.addEventListener(\"visibilitychange\", f)\n    return () => document.removeEventListener(\"visibilitychange\", f)\n  }, [ready])\n}"],"names":["useAutoRef","useEffect"],"mappings":";;;;;;;AAIA;;;AAGG;AACG,SAAU,UAAU,CAAC,KAAY,EAAA;IAC7B,IAAA,KAAK,GAAY,KAAK,CAAA,KAAjB,EAAE,KAAK,GAAK,KAAK,CAAA,KAAV,CAAU;AAE9B,IAAA,IAAM,QAAQ,GAAGA,gBAAU,CAAC,KAAK,CAAC,CAAA;AAElC,IAAAC,eAAS,CAAC,YAAA;AACR,QAAA,IAAI,CAAC,KAAK;YAAE,OAAM;AAElB,QAAA,IAAM,CAAC,GAAG,YAAM,EAAA,OAAA,CAAC,QAAQ,CAAC,MAAM,IAAI,QAAQ,CAAC,OAAO,EAAE,CAAA,EAAA,CAAA;AAEtD,QAAA,QAAQ,CAAC,gBAAgB,CAAC,kBAAkB,EAAE,CAAC,CAAC,CAAA;AAChD,QAAA,OAAO,YAAM,EAAA,OAAA,QAAQ,CAAC,mBAAmB,CAAC,kBAAkB,EAAE,CAAC,CAAC,CAAnD,EAAmD,CAAA;AAClE,KAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAA;AACb;;;;"}