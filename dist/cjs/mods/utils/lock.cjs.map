{"version":3,"file":"lock.cjs","sources":["../../../../src/mods/utils/lock.ts"],"sourcesContent":["export class Lock {\n  private mutex?: Promise<unknown>\n\n  async lock<T>(callback: () => Promise<T>) {\n    if (this.mutex) await this.mutex\n    const promise = callback()\n    this.mutex = promise\n    return await promise\n  }\n}"],"names":[],"mappings":";;;;;;AAAA,IAAA,IAAA,kBAAA,YAAA;AAAA,IAAA,SAAA,IAAA,GAAA;KASC;IANO,IAAI,CAAA,SAAA,CAAA,IAAA,GAAV,UAAc,QAA0B,EAAA;;;;;;6BAClC,IAAI,CAAC,KAAK,EAAV,OAAU,CAAA,CAAA,YAAA,CAAA,CAAA,CAAA;wBAAE,OAAM,CAAA,CAAA,YAAA,IAAI,CAAC,KAAK,CAAA,CAAA;;AAAhB,wBAAA,EAAA,CAAA,IAAA,EAAgB,CAAA;;;wBAC1B,OAAO,GAAG,QAAQ,EAAE,CAAA;AAC1B,wBAAA,IAAI,CAAC,KAAK,GAAG,OAAO,CAAA;AACb,wBAAA,OAAA,CAAA,CAAA,YAAM,OAAO,CAAA,CAAA;AAApB,oBAAA,KAAA,CAAA,EAAA,OAAA,CAAA,CAAA,aAAO,SAAa,CAAA,CAAA;;;;AACrB,KAAA,CAAA;IACH,OAAC,IAAA,CAAA;AAAD,CAAC,EAAA;;;;"}